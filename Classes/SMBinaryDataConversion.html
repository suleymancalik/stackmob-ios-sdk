<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>SMBinaryDataConversion Class Reference</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<meta name="viewport" content="width=550" />
		<link rel="stylesheet" type="text/css" href="../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.0.5 (build 789)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../index.html">StackMob iOS SDK </a></h1>
				<a id="developerHome" href="../index.html">StackMob</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">SMBinaryDataConversion Class Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar">
				<li id="toc_button">
					<button aria-label="Show Table of Contents" role="checkbox" class="open" id="table_of_contents"><span class="disclosure"></span>Table of Contents</button>
				</li>
				<li id="jumpto_button" role="navigation">
					<select id="jumpTo">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	
	
	
	
	<option value="tasks">Tasks</option>
	
	
	
	
	
	
	
	<option value="class_methods">Class Methods</option>
	
	<option value="//api/name/dataForString:">&nbsp;&nbsp;&nbsp;&nbsp;+ dataForString:</option>
	
	<option value="//api/name/stringContainsURL:">&nbsp;&nbsp;&nbsp;&nbsp;+ stringContainsURL:</option>
	
	<option value="//api/name/stringForBinaryData:name:contentType:">&nbsp;&nbsp;&nbsp;&nbsp;+ stringForBinaryData:name:contentType:</option>
	
	
	
	
	
</select>
				</li>
			</ul>
		</header>
		<nav id="tocContainer" class="isShowingTOC">
			<ul id="toc" role="tree">
				
<li role="treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#overview">Overview</a></span></li>




<li role="treeitem" id="task_treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#tasks">Tasks</a></span><ul>
	
</ul></li>







<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#class_methods">Class Methods</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/dataForString:">dataForString:</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/stringContainsURL:">stringContainsURL:</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/stringForBinaryData:name:contentType:">stringForBinaryData:name:contentType:</a></span></li>
	
</ul></li>




			</ul>
		</nav>
		<article>
			<div id="contents" class="isShowingTOC" role="main">
				<a title="SMBinaryDataConversion Class Reference" name="top"></a>
				<div class="main-navigation navigation-top">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">SMBinaryDataConversion Class Reference</h1>
					</div>		
				</div>
				<div id="container">	
					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<td class="specification-title">Inherits from</td>
	<td class="specification-value">NSObject</td>
</tr><tr>
	<td class="specification-title">Declared in</td>
	<td class="specification-value">SMBinaryDataConversion.h<br />SMBinaryDataConversion.m</td>
</tr>
						</tbody></table></div>
					
					
					
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p><code>SMBinaryDataConversion</code> offers a class method <a href="#//api/name/stringForBinaryData:name:contentType:">stringForBinaryData:name:contentType:</a> to decode binary data into a string.  This is then used to send to StackMob as the value for a field with type Binary Data.  The contents of the string will be parsed and the content will be stored on s3.  StackMob will then store the public url as the value.  A call to <code>refreshObject:mergeChanges:</code> on the managed object context will update the in-memory value to the url in the persistent store.</p>

<h2>Example s3 Integration</h2>

<p>Once you have your content in <code>NSData</code> form, pass it to the <a href="#//api/name/stringForBinaryData:name:contentType:">stringForBinaryData:name:contentType:</a> method.</p>

<pre><code>NSBundle *bundle = [NSBundle bundleForClass:[self class]];
NSString* pathToImageFile = [bundle pathForResource:@"coolPic" ofType:@"jpg"];
NSData *theData = [NSData dataWithContentsOfFile:pathToImageFile];

NSString *picData = [SMBinaryDataConversion stringForBinaryData:theData name:@"whateverNameYouWant" contentType:@"image/jpg"];
</code></pre>

<p>You can now set the string value, save the managed object context, and refresh your in-memory copy of the object to grab the url pointing to your data.</p>

<pre><code>[newManagedObject setValue:picData forKey:@"pic"];

NSError *error = nil;
// context is your managed object context
if (![context save:&amp;error]) {
NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
abort();
} else {
[context refreshObject:newManagedObject mergeChanges:YES];
}
</code></pre>

<p><code>[newManagedObject valueForKey:@"pic"]</code> now returns the s3 url for the data.</p>

<h2>Saving Binary Data Offline</h2>

<p>When you save an object with binary data while the device is offline, the value of the attribute will contain a data representation, ready to be saved to StackMob. In order to properly read it at that point, the data must be extracted from the string and decoded.</p>

<p>In order to check if the attribute value is a url or not, use the <a href="#//api/name/stringContainsURL:">stringContainsURL:</a> method.  To convert the string value back to data, use the <a href="#//api/name/dataForString:">dataForString:</a> method.</p>

<pre><code>NSString *picString = [newManagedObject valueForKey:@"pic"];
if ([SMBinaryDataConversion stringContainsURL:picString]) {
    NSURL *urlForPic = [NSURL URLForString:picString];
    // Set image from url

} else {
    UIImage *image = [UIImage imageWithData:[SMBinaryDataConversion dataForString:picString]];
    // Set image directly
}
</code></pre><div class="note"><p><strong>Note:</strong> Binary Data fields are not inferred. You must edit the schema on the StackMob website and add a new field of type Binary Data that has the same name as the string attribute in your Xcode data model.  This must be done before you persist any data to avoid inferring a field with type string.</p></div>
					</div>
					
					
					
					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						<h2 class="subtitle subtitle-tasks">Tasks</h2>
						
						
						
						

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/stringForBinaryData:name:contentType:">+&nbsp;stringForBinaryData:name:contentType:</a></code>
		<span class="tooltip"><p>Returns a string version of binary data used by StackMob to upload content to s3.</p></span>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/dataForString:">+&nbsp;dataForString:</a></code>
		<span class="tooltip"><p>Returns the data representation of a string created with <a href="#//api/name/stringForBinaryData:name:contentType:">stringForBinaryData:name:contentType:</a>.</p></span>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/stringContainsURL:">+&nbsp;stringContainsURL:</a></code>
		<span class="tooltip"><p>Given a string attribute which maps to a Binary field on StackMob, returns whether the string contains an s3 URL.</p></span>
	</span>
	
	
</li>
						</ul>
						
					</div>
					
					
					
					
					
					
					
					<div class="section section-methods">
						<a title="Class Methods" name="class_methods"></a>
						<h2 class="subtitle subtitle-methods">Class Methods</h2>
						
						<div class="section-method">
	<a name="//api/name/dataForString:" title="dataForString:"></a>
	<h3 class="subsubtitle method-title">dataForString:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Returns the data representation of a string created with <a href="#//api/name/stringForBinaryData:name:contentType:">stringForBinaryData:name:contentType:</a>.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>+ (NSData *)dataForString:(NSString *)<em>string</em></code></div>

    
	
	<div class="method-subsection arguments-section parameters">
		<h4 class="method-subtitle parameter-title">Parameters</h4>
		
		<dl class="argument-def parameter-def">
			<dt><em>string</em></dt>
			<dd><p>The string to convert to data.</p></dd>
		</dl>
		
	</div>
	
	
	
	<div class="method-subsection return">
		<h4 class="method-subtitle parameter-title">Return Value</h4>
		<p>The data representation of the string.</p>
	</div>
	
	
	
	<div class="method-subsection availability">
		<h4 class="method-subtitle parameter-title">Availability</h4>
		<p>Available in iOS SDK 2.0.0 and later.</p>
	</div>
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Use this method when pulling the attribute value when the object has not yet been synced with the server, i.e. does not yet contain a proper s3 url.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">SMBinaryDataConversion.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/stringContainsURL:" title="stringContainsURL:"></a>
	<h3 class="subsubtitle method-title">stringContainsURL:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Given a string attribute which maps to a Binary field on StackMob, returns whether the string contains an s3 URL.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>+ (BOOL)stringContainsURL:(NSString *)<em>value</em></code></div>

    
	
	<div class="method-subsection arguments-section parameters">
		<h4 class="method-subtitle parameter-title">Parameters</h4>
		
		<dl class="argument-def parameter-def">
			<dt><em>value</em></dt>
			<dd><p>The string to evaluate.</p></dd>
		</dl>
		
	</div>
	
	
	
	<div class="method-subsection return">
		<h4 class="method-subtitle parameter-title">Return Value</h4>
		<p>YES if the string contains an s3 url, otherwise NO.</p>
	</div>
	
	
	
	<div class="method-subsection availability">
		<h4 class="method-subtitle parameter-title">Availability</h4>
		<p>Available in iOS SDK 2.0.0 and later.</p>
	</div>
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>If the object has already been saved and persisted to StackMob, the string will contain the s3 url which maps to the data.  Otherwise the object will contain a data representation, ready to be saved to StackMob. In order to properly read it the data must be extracted from the string and decoded using the <a href="#//api/name/dataForString:">dataForString:</a> method.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">SMBinaryDataConversion.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/stringForBinaryData:name:contentType:" title="stringForBinaryData:name:contentType:"></a>
	<h3 class="subsubtitle method-title">stringForBinaryData:name:contentType:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Returns a string version of binary data used by StackMob to upload content to s3.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>+ (NSString *)stringForBinaryData:(NSData *)<em>data</em> name:(NSString *)<em>name</em> contentType:(NSString *)<em>contentType</em></code></div>

    
	
	<div class="method-subsection arguments-section parameters">
		<h4 class="method-subtitle parameter-title">Parameters</h4>
		
		<dl class="argument-def parameter-def">
			<dt><em>data</em></dt>
			<dd><p>The actual content in <code>NSData</code> form.</p></dd>
		</dl>
		
		<dl class="argument-def parameter-def">
			<dt><em>name</em></dt>
			<dd><p>A name for the content.  This can be any arbitrary name.</p></dd>
		</dl>
		
		<dl class="argument-def parameter-def">
			<dt><em>contentType</em></dt>
			<dd><p>The content type of the data. See <a href="http://en.wikipedia.org/wiki/Internet%5fmedia%5ftype">Internet Media Type</a> for a full list.</p></dd>
		</dl>
		
	</div>
	
	
	
	<div class="method-subsection return">
		<h4 class="method-subtitle parameter-title">Return Value</h4>
		<p>A string formatted for StackMob to persist data to s3.</p>
	</div>
	
	
	
	<div class="method-subsection availability">
		<h4 class="method-subtitle parameter-title">Availability</h4>
		<p>Available in iOS SDK 1.0.0 and later.</p>
	</div>
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">SMBinaryDataConversion.h</code><br />
	</div>				
	
	
</div>
						
					</div>
					
					
					
					
				</div>
				<div class="main-navigation navigation-bottom">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2013 StackMob. All rights reserved. (Last updated: 2013-05-13)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.0.5 (build 789)</a>.</span></p>
						
					</div>
				</div>
			</div>
		</article>
		<script type="text/javascript">
			function jumpToChange()
			{
				window.location.hash = this.options[this.selectedIndex].value;
			}
			
			function toggleTOC()
			{
				var contents = document.getElementById('contents');
				var tocContainer = document.getElementById('tocContainer');
				
				if (this.getAttribute('class') == 'open')
				{
					this.setAttribute('class', '');
					contents.setAttribute('class', '');
					tocContainer.setAttribute('class', '');
					
					window.name = "hideTOC";
				}
				else
				{
					this.setAttribute('class', 'open');
					contents.setAttribute('class', 'isShowingTOC');
					tocContainer.setAttribute('class', 'isShowingTOC');
					
					window.name = "";
				}
				return false;
			}
			
			function toggleTOCEntryChildren(e)
			{
				e.stopPropagation();
				var currentClass = this.getAttribute('class');
				if (currentClass == 'children') {
					this.setAttribute('class', 'children open');
				}
				else if (currentClass == 'children open') {
					this.setAttribute('class', 'children');
				}
				return false;
			}
			
			function tocEntryClick(e)
			{
				e.stopPropagation();
				return true;
			}
			
			function init()
			{
				var selectElement = document.getElementById('jumpTo');
				selectElement.addEventListener('change', jumpToChange, false);
				
				var tocButton = document.getElementById('table_of_contents');
				tocButton.addEventListener('click', toggleTOC, false);
				
				var taskTreeItem = document.getElementById('task_treeitem');
				if (taskTreeItem.getElementsByTagName('li').length > 0)
				{
					taskTreeItem.setAttribute('class', 'children');
					taskTreeItem.firstChild.setAttribute('class', 'disclosure');
				}
				
				var tocList = document.getElementById('toc');
				
				var tocEntries = tocList.getElementsByTagName('li');
				for (var i = 0; i < tocEntries.length; i++) {
					tocEntries[i].addEventListener('click', toggleTOCEntryChildren, false);
				}
				
				var tocLinks = tocList.getElementsByTagName('a');
				for (var i = 0; i < tocLinks.length; i++) {
					tocLinks[i].addEventListener('click', tocEntryClick, false);
				}
				
				if (window.name == "hideTOC") {
					toggleTOC.call(tocButton);
				}
			}
			
			window.onload = init;
			
			// If showing in Xcode, hide the TOC and Header
			if (navigator.userAgent.match(/xcode/i)) {
				document.getElementById("contents").className = "hideInXcode"
				document.getElementById("tocContainer").className = "hideInXcode"
				document.getElementById("top_header").className = "hideInXcode"
			}
			
		</script>
	</body>
</html>